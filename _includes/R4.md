## <span style="color:#ff201e">Predictive Power</span>

<div class="section" style="margin-top:18px;">

<div style="background:#f4f6fa; padding:16px; border-left:4px solid #4a6cf7; border-radius:6px; margin:14px 0;">
  Which of the three similarity metrics shared authorship, stylometric, psychological best predicts whether an inter-community hyperlink is positive or negative?
</div>

<p>
In order to get answers, we first compare the predictive power of the three single-feature models. Then, we test a combined model that takes into account the three metrics, shared authorship, stylometric and psychological similarities. By evaluating the obtained results, we look for the model than outperforms others in predicting hyperlink sentiment. 
</p>
<hr style="margin:18px 0;">

<h4><span style="color:#ff201e">4.1 Predictive power overview</span></h4>

<p>
We study three single-feature classifiers (one per distance metric) as well as a combined classifier using all three distances that could yield better results. <br>
We proceed with two model families: <em>Logistic Regression</em> and <em>Random Forest</em>. <br>
Performance is measured with the <b>F1 score</b> (balance of precision and recall) and <b>ROC-AUC</b> (how well the model separates positive and negative cases).
</p>

<div style="display:flex; gap:12px; margin-top:12px; align-items:center;">
  <div style="background:#fff7ed; padding:12px; border-radius:8px;">
    <strong>Hypothesis A</strong><br>
    Shared authorship will be the strongest single predictor.
  </div>
  <div style="background:#eef7ff; padding:12px; border-radius:8px;">
    <strong>Hypothesis B</strong><br>
    A model using all three distances should do better than any single-feature model.
  </div>
</div>

<hr style="margin:18px 0;">


<h4><span style="color:#ff201e">4.2 Logistic regression, what are the key formulas & setup ?</span></h4>

<p>We train logistic regression models using stratified k-fold cross-validation and report the mean and standard deviation for F1 and ROC-AUC.</p>

<div style="display:flex; gap:16px; flex-wrap:wrap; margin-top:12px;">
  <div style="background:#f6f9fa; padding:12px; border-radius:8px; min-width:300px;">
    <div style="font-weight:600; margin-bottom:6px;">F1 score</div>
\(\text{F1} = 2 \cdot \frac{\text{Precision}\cdot \text{Recall}}{\text{Precision} + \text{Recall}}\)
  </div>

  <div style="background:#f6f9fa; padding:12px; border-radius:8px; min-width:300px;">
    <div style="font-weight:600; margin-bottom:6px;">Precision &amp; Recall</div>
\(\text{Precision} = \frac{\text{TP}}{\text{TP} + \text{FP}} \) <br>
\(\text{Recall}    = \frac{\text{TP}}{\text{TP} + \text{FN}} \)
  </div>

  <div style="background:#f6f9fa; padding:12px; border-radius:8px; min-width:300px;">
    <div style="font-weight:600; margin-bottom:6px;">Logistic model</div>
    <pre style="margin:0; font-family:monospace;">
P(y=1|X) = sigmoid(β0 + β1·x1 + β2·x2 + β3·x3)
sigmoid(z) = 1 / (1 + exp(-z))
    </pre>
  </div>
</div>

<hr style="margin:18px 0;">


<h4><span style="color:#ff201e">4.3 Results : Logistic regression with imbalanced data</span></h4>

<div style="display:flex; gap:18px; flex-wrap:wrap; margin-top:8px;">
  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Psychological distance</strong><br><br>
    F1: <b>0.206 ± 0.001</b><br>
    AUC: <b>0.584 ± 0.003</b>
  </div>

  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Authors distance</strong><br><br>
    F1: <b>0.219 ± 0.001</b><br>
    AUC: <b>0.606 ± 0.002</b>
  </div>

  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Stylometric distance</strong><br><br>
    F1: <b>0.171 ± 0.002</b><br>
    AUC: <b>0.511 ± 0.003</b>
  </div>
</div>

<div style="margin-top:12px; font-size:0.95rem;">
  <p><b>Interpretation</b></p>
  <ul>
    <li>Shared authorship is the strongest single predictor, though an AUC around 0.60 still suggests limited accuracy overall.</li>
    <li>Psychological distance provides slighty smaller results, with an AUC around 0.58.</li>
    <li>Stylometric distance adds almost no separation (AUC around 0.51, close to chance level).</li>
  </ul>
</div>

<div style="text-align:center; margin-top:14px;">
  <img src="assets/img/R4/logreg_f1_auc_single_features.png" width="70%" alt="LogReg F1 and AUC per feature">
  <div style="font-size:0.85rem;"><em>Left: F1 per feature. Right: ROC-AUC per feature.</em></div>
</div>

<hr style="margin:18px 0;">


<h4><span style="color:#ff201e">4.4 Downsampling with balanced blasses</span></h4>

<p>The dataset is highly imbalanced: around 678k positive links vs about 76k negative ones (roughly 89% vs 11%).  
We balance the classes by downsampling the majority class and rerun the logistic regression.</p>

<div style="display:flex; gap:12px; margin-top:10px;">

  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; min-width:320px; font-size:19px;">
    <strong>Downsampled results</strong><br><br>
    Psychological: <br>
    F1 <b>0.569 ± 0.001</b><br>
    AUC <b>0.583 ± 0.002</b><br><br>
    Authors: <br>       
    F1 <b>0.589 ± 0.002</b><br>
    AUC <b>0.604 ± 0.001</b><br><br>
    Stylometric:   
    F1 <b>0.488 ± 0.003</b><br> 
    AUC <b>0.511 ± 0.002</b><br>
  </div>

  <div style="background:#fff7ef; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Key note</strong><br><br>
    The F1 score climbs sharply when the classes are balanced, but the ROC-AUC barely moves.  
    The F1 improvement mainly reflects the artificial balance rather than an increase in true predictive power.
  </div>

</div>

<div style="text-align:center; margin-top:14px;">
  <img src="assets/img/R4/downsampling.png" width="70%" alt="LogReg F1 and AUC per feature">
  <div style="font-size:0.85rem;"><em>Left: F1 per feature. Right: ROC-AUC per feature.</em></div>
</div>

<div style="margin-top:12px;">
  <p><b>Takeaway:</b> balancing the dataset boosts metrics in relation to class ratios (precision, recall, F1) but does not change how well the model actually separates positive from negative links, as shown by the nearly unchanged ROC-AUC.</p>
</div>

<hr style="margin:18px 0;">


<h4><span style="color:#ff201e">4.5 Logistic regression : combined models</span></h4>

<p>We compare two logistic models: (A) using all three distances, and (B) using only authorship + psychological distance, leaving out stylometric, as we assume its effect is minimal.</p>

<div style="display:flex; gap:12px; margin-top:10px;">
  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; min-width:320px; font-size:19px;">
    <strong>All three distances</strong><br><br>
    F1 per fold: [0.2199, 0.2234, 0.2195, 0.2198, 0.2192]<br><br>
    F1: <b>0.220 ± 0.002</b><br>
    AUC: <b>0.615 ± 0.003</b>
  </div>

  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Authors + Psychological</strong><br><br>
    F1 per fold: [0.2174, 0.2199, 0.2160, 0.2174, 0.2169]<br><br>
    F1: <b>0.218 ± 0.001</b><br>
    AUC: <b>0.610 ± 0.002</b>
  </div>
</div>

<div style="margin-top:12px;">
  <p>
    Adding stylometric distance raises the combined model’s AUC slightly (0.615 instead of 0.610).  
    It’s a small but consistent improvement across folds, suggesting stylometry provides a little extra information even if it’s weak on its own.
  </p>
</div>

<div style="text-align:center; margin-top:14px">
  <img src="assets/img/R4/logreg_combined_boxplots.png" width="80%" alt="Combined vs authors+psych logistic boxplots">
  <div style="font-size:0.85rem;"><em>Boxplots comparing AUC and F1 across folds.</em></div>
</div>

<hr style="margin:18px 0;">

#### Superiority of predictive power of the combined model

For the model combining all three metrics, we obtained an AUC of 0.615 ± 0.003. This result exceeds the best individual metric performance (shared authorship), which achieved an AUC of 0.605. We can therefore conclude that a model combining the three metrics possesses slightly better predictive power than models relying on individual metrics.


<h4><span style="color:#ff201e">4.6 Random Forest : combined model</span></h4>

<p>We run a stratified 5-fold Random Forest using all three metrics.  
Its performance shows a clear step up compared to logistic regression.</p>

<div style="display:flex; gap:12px; margin-top:10px;">
  <div style="background:#fff; border:1px solid #e6e9ec; padding:12px; border-radius:8px; min-width:320px; font-size:19px;">
    <strong>Random Forest (all 3)</strong><br><br>
    F1 per fold: [0.298, 0.300, 0.295, 0.294, 0.297]<br>
    <b>Mean F1: 0.297 ± 0.002</b><br><br>
    AUC per fold: [0.723, 0.727, 0.720, 0.722, 0.725]<br>
    <b>Mean AUC: 0.723 ± 0.002</b>
  </div>

  <div style="background:#f0fff4; padding:12px; border-radius:8px; font-size:19px;">
    <strong>Improvement</strong><br>
    Compared with logistic regression, the Random Forest increases the AUC from about 0.615 to roughly 0.723 : a significant jump in performance.
  </div>
</div>



<div style="text-align:center; margin-top:14px;">
  <img src="assets/img/R4/rf_tree_visualization.png" width="80%" alt="Random forest tree visualization">
  <div style="font-size:0.85rem;"><em>Top-level splits from a tree in the forest (example).</em></div>
</div>

<div style="background:#f7f9fc; padding:20px; border-radius:10px; line-height:1.6; font-size:15px;">

  <p style="margin-top:0;">
    Above we see the first few splits of our decision tree.<br>
    Here is an explanation of each element:
  </p>

  <ul style="margin:10px 0 0 20px; padding:0;">
    <li>
      <b>authors_cos_distance / psychological_cos_distance</b>: 
      represent the cosine distance for each feature.
    </li>

    <li>
      <b>Gini (0 to 1)</b>: measures how mixed the classes are in a node.  
      <i>0 indicates perfect purity</i> (all samples in one class),  
      while higher values indicate more class mixing.
    </li>

    <li>
      <b>samples</b>: total number of elements in the node.
    </li>

    <li>
      <b>value</b>: class distribution among the samples.  
      On the left-hand side we have <b>link_sentiment = 1</b>,  
      and on the right-hand side <b>link_sentiment = -1</b>.
    </li>
  </ul>

</div>

<h5><span style="color:black">Visualization ROC</span></h5>

Finally, we plot the ROC curve to visualize the classifier's performance and the AUC score.

<div style="text-align:center; margin-top:14px;">
  <img src="assets/img/R4/rf_roc_curve.png" width="72%" alt="Random forest ROC curve">
  <div style="font-size:0.85rem;"><em>ROC curve with an AUC of about 0.723 for the Random Forest.</em></div>
</div>

<hr style="margin:18px 0;">

<h4><span style="color:#ff201e">4.7 Feature importance & stylometric usefulness</span></h4>

<p>
We inspect Random Forest feature importances to understand the contribution of each metric.
</p>

<div style="text-align:center; margin-top:12px;">
  <img src="assets/img/R4/feature_importance_rf.png" width="60%" alt="Feature importances">
  <div style="font-size:0.85rem;"><em>Shared authorship leads; psychological and stylometric both add value.</em></div>
</div>

<p style="margin-top:10px;">
Summary of findings:
<ul>
  <li><b>Shared authorship</b> is the most influential feature across all models.</li>
  <li><b>Psychological distance</b> offers a steady and helpful signal.</li>
  <li><b>Stylometric distance</b> is weak on its own but slightly improves combined models and has a noticeable role in the Random Forest.</li>
</ul>
</p>

<hr style="margin:18px 0;">


<h4><span style="color:#ff201e">4.8 Final conclusions</span></h4>

<div style="background:#eef1f5; padding:16px; border-radius:10px;">
  <ol>
    <li>Does shared authorship distance is the most predictive individual metric ? <br> 
    <b>Yes !</b> shared authorship distance has the highest AUC and F1.</li>
    <li>Does combining distances improves performance ? <br>
    <b>Yes, but only slightly...</b> Logistic regression reaches around 0.615 AUC, while Random Forest pushes that up to about 0.723.</li>
    <li>Is stylometric distance totally useless on the prediction when included in the combined predictive model ? <b>Not supported !</b> stylometric distance is weak alone, but it still adds a small, steady improvement when combined with the others.</li>
  </ol>

  <p style="margin-top:8px;">
    Practical takeaway: authorship distance and psychological distance together form a solid starting point.  
    Bringing stylometric distance into the mix gives a small but reliable boost, and Random Forests clearly extract more structure from the data than linear models.
  </p>
</div>

</div>



<div class="ignore">
  # <span style="color: #ff201e">Quick.</span> The fastest and easiest way to&nbsp;create a&nbsp;GitHub Pages website for your project.
  #### The Quick theme magically transforms your `README.md` into a GitHub Pages site, applying clean and visually appealing styles.

  <p class="ignore">Just see it yourself&thinsp;—&thinsp;<a href="https://devich.github.io/quick/">this page</a> is the same <code>README.md</code> file you’re reading, but with the Quick theme applied:</p>

  <a class="ignore" href="https://devich.github.io/quick/"><img src="assets/img/preview.png" alt="Quick preview"></a>

  ## Quick start

  1. Make sure a `README.md` file exists in the root directory of your repo, and GitHub Pages is enabled in your repository settings.

  2. Create a file named `_config.yml` in the root directory of your repository. The file should contain the following content:
  ```yaml
  remote_theme: devich/quick@0.0.1
  ```

  3. That’s it! There is no step 3. You now have a GitHub Pages website that’s based on your `README.md` file. The changes will take effect some time after you commit and push your updates to the repository. Enjoy your new website!


  ## Looking for a simple landing page for your project? 

  No problem! You’re not restricted to using `readme.md` as the index page of your site. Simply create a file named `index.md`, and this theme will use it as the home page. Feel free to create as many pages as you want and link them within your site.

  For instance, if you need a home page and an ‘About’ page, create files named `index.md` and `about.md`. Inside the `index.md` file, you can link to your ‘About’ page like this:

  ```md
  [About this project](about)
  ```


  ## Fine tuning
  ### Additional settings in _config.yml

  You can set additional parameters for the site in the `_config.yml` file.

  The following options are available:

  - `lang:` sets the language of the site. E.g. `en-US`, `uk`, `pl`, `fr-CA` and so on. The default value is `en-US`.
  - `bg_color:` sets the background color of your website. Can be `dark`, `light` or `auto`. The default value is `auto`.
  - `theme_color:` sets the main accent color for buttons, links, etc. It can be <nobr><code class="highlighter-rouge" style="color:#c52f21">red</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#d92662">pink</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#c0208a">fuchsia</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#9136a3">purple</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#7540be">violet</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#524ed1">indigo</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#2060de">blue</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#0172ac">azure</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#047878">cyan</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#007a50">jade</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#398712">green</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#a5d601">lime</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#f2df0d">yellow</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#ffbf00">amber</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#ff9500">pumpkin</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#d24317">orange</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#ccc6b4">sand</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#ababab">grey</code>,</nobr> <nobr><code class="highlighter-rouge" style="color:#646b79">zinc</code> or <nobr><code class="highlighter-rouge" style="color:#525f7a">slate</code>.</nobr> The default value is <nobr><code class="highlighter-rouge" style="color:#0172ac">azure</code>.
  - `title:` sets the title of the site. If not set, your repository name will be used.
  - `description`: sets the meta description tag, which typically contains a concise, relevant summary of the page’s content.
  - `keywords`: sets keywords for the page, separated with commas.
  - `gtag`: sets your Google Analytics tag if needed (e.g. G-A1BCDEFGHI).

  Alternatively, you can copy the contents of the `_config.yml` file from the [theme repository](https://github.com/devich/quick/blob/main/_config.yml) into your own `_config.yml` file. This will give you access to all available options at once.



  ### Ignoring

  If there’s a block in the `README.md` file that you don’t want to display on the GitHub Pages site, you can format this block as HTML and assign the `class="ignore"` attribute to it.

  <p class="ignore">
      This paragraph <a href="https://devich.github.io/quick/">will not be displayed</a>
      on the site because it has an <code>"ignore"</code> class.
  </p>

  ```html
  <p class="ignore">
      This paragraph <a href="https://devich.github.io/quick/">will not be
      displayed</a> on the site because it has an <code>"ignore"</code> class.
  </p>
  ```


  ### More customization

  If you need to use your own CSS styles, create a file `assets/css/custom.css` in your repository and add your styles to it.

  For a custom favicon, just place your file in `PNG` format at `assets/img/favicon.png`.

  For full control, clone this repository and modify the template as you need.

  {% include basic_plots/distrib_cosine_dist_embeddings.html %}
</div>
